-- Documentation here: https://ciqual.anses.fr/cms/sites/default/files/inline-files/Table%20CALNUT%202020_doc_FR_2020%2007%2007.pdf
-- From table 0 we get the food group and subgroup
-- From table 1 we get upper_bound, lower_bound, mean, and an indicator of the completeness of the data
-- Both tables are joined by the ALIM_CODE and FOOD_LABEL columns
CREATE OR REPLACE TABLE calnut AS
WITH
calnut_0 AS (
    SELECT ALIM_CODE, FOOD_LABEL,
    alim_grp_code, alim_grp_nom_fr,
    alim_ssgrp_code, alim_ssgrp_nom_fr,
    alim_ssssgrp_code, alim_ssssgrp_nom_fr
    FROM read_csv($calnut_0_path)
),
calnut_1 AS (
    SELECT ALIM_CODE, FOOD_LABEL, CONST_LABEL, LB as lb, UB as ub, MB as mean, indic_combl as combl
    FROM read_csv($calnut_1_path)
),
calnut_1_pivoted AS (
    SELECT ALIM_CODE, FOOD_LABEL,
MAX(CAST(CASE WHEN CONST_LABEL = 'acides_organiques_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as acides_organiques_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'acides_organiques_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as acides_organiques_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'acides_organiques_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as acides_organiques_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'acides_organiques_g' THEN combl END AS INT)) as acides_organiques_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_04_0_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_04_0_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_04_0_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_04_0_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_04_0_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_04_0_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_04_0_g' THEN combl END AS INT)) as ag_04_0_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_06_0_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_06_0_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_06_0_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_06_0_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_06_0_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_06_0_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_06_0_g' THEN combl END AS INT)) as ag_06_0_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_08_0_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_08_0_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_08_0_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_08_0_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_08_0_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_08_0_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_08_0_g' THEN combl END AS INT)) as ag_08_0_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_10_0_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_10_0_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_10_0_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_10_0_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_10_0_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_10_0_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_10_0_g' THEN combl END AS INT)) as ag_10_0_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_12_0_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_12_0_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_12_0_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_12_0_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_12_0_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_12_0_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_12_0_g' THEN combl END AS INT)) as ag_12_0_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_14_0_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_14_0_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_14_0_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_14_0_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_14_0_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_14_0_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_14_0_g' THEN combl END AS INT)) as ag_14_0_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_16_0_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_16_0_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_16_0_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_16_0_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_16_0_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_16_0_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_16_0_g' THEN combl END AS INT)) as ag_16_0_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_0_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_18_0_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_0_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_18_0_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_0_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_18_0_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_0_g' THEN combl END AS INT)) as ag_18_0_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_1_ole_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_18_1_ole_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_1_ole_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_18_1_ole_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_1_ole_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_18_1_ole_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_1_ole_g' THEN combl END AS INT)) as ag_18_1_ole_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_2_lino_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_18_2_lino_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_2_lino_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_18_2_lino_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_2_lino_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_18_2_lino_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_2_lino_g' THEN combl END AS INT)) as ag_18_2_lino_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_3_a_lino_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_18_3_a_lino_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_3_a_lino_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_18_3_a_lino_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_3_a_lino_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_18_3_a_lino_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_18_3_a_lino_g' THEN combl END AS INT)) as ag_18_3_a_lino_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_4_ara_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_20_4_ara_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_4_ara_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_20_4_ara_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_4_ara_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_20_4_ara_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_4_ara_g' THEN combl END AS INT)) as ag_20_4_ara_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_5_epa_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_20_5_epa_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_5_epa_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_20_5_epa_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_5_epa_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_20_5_epa_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_5_epa_g' THEN combl END AS INT)) as ag_20_5_epa_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_6_dha_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ag_20_6_dha_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_6_dha_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ag_20_6_dha_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_6_dha_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ag_20_6_dha_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ag_20_6_dha_g' THEN combl END AS INT)) as ag_20_6_dha_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'agmi_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as agmi_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'agmi_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as agmi_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'agmi_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as agmi_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'agmi_g' THEN combl END AS INT)) as agmi_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'agpi_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as agpi_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'agpi_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as agpi_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'agpi_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as agpi_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'agpi_g' THEN combl END AS INT)) as agpi_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'ags_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as ags_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'ags_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as ags_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'ags_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as ags_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'ags_g' THEN combl END AS INT)) as ags_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'alcool_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as alcool_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'alcool_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as alcool_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'alcool_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as alcool_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'alcool_g' THEN combl END AS INT)) as alcool_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'amidon_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as amidon_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'amidon_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as amidon_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'amidon_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as amidon_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'amidon_g' THEN combl END AS INT)) as amidon_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'beta_carotene_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as beta_carotene_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'beta_carotene_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as beta_carotene_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'beta_carotene_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as beta_carotene_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'beta_carotene_mcg' THEN combl END AS INT)) as beta_carotene_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'calcium_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as calcium_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'calcium_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as calcium_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'calcium_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as calcium_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'calcium_mg' THEN combl END AS INT)) as calcium_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'cholesterol_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as cholesterol_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'cholesterol_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as cholesterol_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'cholesterol_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as cholesterol_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'cholesterol_mg' THEN combl END AS INT)) as cholesterol_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'cuivre_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as cuivre_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'cuivre_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as cuivre_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'cuivre_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as cuivre_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'cuivre_mg' THEN combl END AS INT)) as cuivre_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'eau_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as eau_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'eau_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as eau_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'eau_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as eau_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'eau_g' THEN combl END AS INT)) as eau_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'fer_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as fer_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'fer_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as fer_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'fer_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as fer_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'fer_mg' THEN combl END AS INT)) as fer_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'fibres_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as fibres_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'fibres_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as fibres_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'fibres_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as fibres_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'fibres_g' THEN combl END AS INT)) as fibres_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'fructose_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as fructose_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'fructose_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as fructose_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'fructose_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as fructose_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'fructose_g' THEN combl END AS INT)) as fructose_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'galactose_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as galactose_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'galactose_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as galactose_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'galactose_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as galactose_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'galactose_g' THEN combl END AS INT)) as galactose_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'glucides_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as glucides_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'glucides_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as glucides_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'glucides_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as glucides_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'glucides_g' THEN combl END AS INT)) as glucides_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'glucose_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as glucose_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'glucose_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as glucose_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'glucose_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as glucose_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'glucose_g' THEN combl END AS INT)) as glucose_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'iode_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as iode_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'iode_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as iode_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'iode_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as iode_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'iode_mcg' THEN combl END AS INT)) as iode_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'lactose_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as lactose_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'lactose_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as lactose_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'lactose_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as lactose_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'lactose_g' THEN combl END AS INT)) as lactose_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'lipides_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as lipides_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'lipides_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as lipides_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'lipides_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as lipides_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'lipides_g' THEN combl END AS INT)) as lipides_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'magnesium_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as magnesium_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'magnesium_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as magnesium_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'magnesium_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as magnesium_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'magnesium_mg' THEN combl END AS INT)) as magnesium_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'maltose_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as maltose_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'maltose_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as maltose_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'maltose_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as maltose_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'maltose_g' THEN combl END AS INT)) as maltose_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'manganese_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as manganese_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'manganese_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as manganese_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'manganese_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as manganese_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'manganese_mg' THEN combl END AS INT)) as manganese_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'nrj_kcal' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as nrj_kcal_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'nrj_kcal' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as nrj_kcal_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'nrj_kcal' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as nrj_kcal_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'nrj_kcal' THEN combl END AS INT)) as nrj_kcal_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'nrj_kj' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as nrj_kj_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'nrj_kj' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as nrj_kj_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'nrj_kj' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as nrj_kj_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'nrj_kj' THEN combl END AS INT)) as nrj_kj_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'phosphore_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as phosphore_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'phosphore_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as phosphore_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'phosphore_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as phosphore_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'phosphore_mg' THEN combl END AS INT)) as phosphore_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'polyols_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as polyols_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'polyols_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as polyols_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'polyols_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as polyols_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'polyols_g' THEN combl END AS INT)) as polyols_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'potassium_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as potassium_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'potassium_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as potassium_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'potassium_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as potassium_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'potassium_mg' THEN combl END AS INT)) as potassium_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'proteines_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as proteines_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'proteines_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as proteines_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'proteines_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as proteines_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'proteines_g' THEN combl END AS INT)) as proteines_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'retinol_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as retinol_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'retinol_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as retinol_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'retinol_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as retinol_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'retinol_mcg' THEN combl END AS INT)) as retinol_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'saccharose_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as saccharose_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'saccharose_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as saccharose_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'saccharose_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as saccharose_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'saccharose_g' THEN combl END AS INT)) as saccharose_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'sel_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as sel_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'sel_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as sel_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'sel_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as sel_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'sel_g' THEN combl END AS INT)) as sel_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'selenium_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as selenium_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'selenium_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as selenium_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'selenium_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as selenium_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'selenium_mcg' THEN combl END AS INT)) as selenium_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'sodium_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as sodium_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'sodium_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as sodium_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'sodium_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as sodium_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'sodium_mg' THEN combl END AS INT)) as sodium_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'sucres_g' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as sucres_g_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'sucres_g' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as sucres_g_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'sucres_g' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as sucres_g_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'sucres_g' THEN combl END AS INT)) as sucres_g_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b12_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_b12_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b12_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_b12_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b12_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_b12_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b12_mcg' THEN combl END AS INT)) as vitamine_b12_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b1_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_b1_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b1_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_b1_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b1_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_b1_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b1_mg' THEN combl END AS INT)) as vitamine_b1_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b2_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_b2_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b2_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_b2_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b2_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_b2_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b2_mg' THEN combl END AS INT)) as vitamine_b2_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b3_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_b3_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b3_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_b3_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b3_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_b3_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b3_mg' THEN combl END AS INT)) as vitamine_b3_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b5_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_b5_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b5_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_b5_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b5_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_b5_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b5_mg' THEN combl END AS INT)) as vitamine_b5_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b6_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_b6_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b6_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_b6_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b6_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_b6_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b6_mg' THEN combl END AS INT)) as vitamine_b6_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b9_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_b9_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b9_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_b9_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b9_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_b9_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_b9_mcg' THEN combl END AS INT)) as vitamine_b9_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_c_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_c_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_c_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_c_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_c_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_c_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_c_mg' THEN combl END AS INT)) as vitamine_c_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_d_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_d_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_d_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_d_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_d_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_d_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_d_mcg' THEN combl END AS INT)) as vitamine_d_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_e_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_e_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_e_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_e_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_e_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_e_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_e_mg' THEN combl END AS INT)) as vitamine_e_mg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_k1_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_k1_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_k1_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_k1_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_k1_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_k1_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_k1_mcg' THEN combl END AS INT)) as vitamine_k1_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_k2_mcg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as vitamine_k2_mcg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_k2_mcg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as vitamine_k2_mcg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_k2_mcg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as vitamine_k2_mcg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'vitamine_k2_mcg' THEN combl END AS INT)) as vitamine_k2_mcg_combl,
MAX(CAST(CASE WHEN CONST_LABEL = 'zinc_mg' THEN REPLACE(lb, ',', '.') END AS FLOAT)) as zinc_mg_lb,
MAX(CAST(CASE WHEN CONST_LABEL = 'zinc_mg' THEN REPLACE(mean, ',', '.') END AS FLOAT)) as zinc_mg_mean,
MAX(CAST(CASE WHEN CONST_LABEL = 'zinc_mg' THEN REPLACE(ub, ',', '.') END AS FLOAT)) as zinc_mg_ub,
MAX(CAST(CASE WHEN CONST_LABEL = 'zinc_mg' THEN combl END AS INT)) as zinc_mg_combl
FROM calnut_1
GROUP BY ALIM_CODE, FOOD_LABEL
)
SELECT calnut_0.ALIM_CODE, calnut_0.alim_grp_code, calnut_0.alim_ssgrp_code, calnut_0.alim_ssssgrp_code,
    calnut_0.FOOD_LABEL, calnut_0.alim_grp_nom_fr, calnut_0.alim_ssgrp_nom_fr, calnut_0.alim_ssssgrp_nom_fr,
    calnut_1_pivoted.*
FROM calnut_1_pivoted
INNER JOIN calnut_0 ON calnut_1_pivoted.ALIM_CODE = calnut_0.ALIM_CODE
