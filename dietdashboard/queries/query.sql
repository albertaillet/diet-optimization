SELECT
$objective as objective,
price_id,
product_code,
product_name,
ciqual_code,
ciqual_name,
price,
location_osm_display_name,
location_osm_id,
energy_fibre_kj_value,
energy_fibre_kcal_value,
water_value,
protein_value,
carbohydrate_value,
fat_value,
sugars_value,
fructose_value,
galactose_value,
glucose_value,
lactose_value,
maltose_value,
sucrose_value,
starch_value,
fiber_value,
polyols_value,
alcohol_value,
organic_acids_value,
saturated_fat_value,
monounsaturated_fat_value,
polyunsaturated_fat_value,
fa_04_0_value,
fa_06_0_value,
fa_08_0_value,
fa_10_0_value,
fa_12_0_value,
fa_14_0_value,
fa_16_0_value,
fa_18_0_value,
fa_18_1_ole_value,
fa_18_2_lino_value,
fa_18_3_a_lino_value,
fa_20_4_ara_value,
fa_20_5_epa_value,
fa_20_6_dha_value,
cholesterol_value,
salt_value,
calcium_value,
copper_value,
iron_value,
iodine_value,
magnesium_value,
manganese_value,
phosphorus_value,
potassium_value,
selenium_value,
sodium_value,
zinc_value,
retinol_value,
beta_carotene_value,
vitamin_d_value,
vitamin_e_value,
vitamin_k1_value,
vitamin_k2_value,
vitamin_c_value,
vitamin_b1_value,
vitamin_b2_value,
vitamin_pp_value,
pantothenic_acid_value,
vitamin_b6_value,
vitamin_b9_value,
vitamin_b12_value,
FROM final_table
WHERE price IS NOT NULL
  AND price > 0
  AND location_id IN (SELECT UNNEST($locations))
  AND product_quantity > 0;
